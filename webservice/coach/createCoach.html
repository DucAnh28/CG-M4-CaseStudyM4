<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="sorttable.js" type="text/javascript"></script>
    <script>
        function showAllCoach(){
            $.ajax({
                    type:"get",
                    url:"http://localhost:2828/coach",
                    success:function (data){
                        let content="";
                        for (let i=0;i<data.length;i++){
                            content+=`<tr>
        <td>${data[i].id}</td>
        <td>${data[i].name}</td>
        <td>${data[i].country}</td>
        <td>${data[i].achievement}</td>
        <td>${data[i].salary}</td>
        <td>${data[i].role}</td>
        <td><img src="${'http://localhost:2828'+data[i].avatarURL}" width="80" height="80" alt="img"></td>
        <td><a href="${data[i].id}" onclick="deleteCoach(this)">Delete</a></td>
        <td><a href="${data[i].id}" onclick="showFormUpdate(this)">Update</a></td></tr>`;
                        }
                        document.getElementById("list").innerHTML = content;

                    }
                }
            )
        }
        showAllCoach();


        function createCoach() {
            let formData = new FormData();
            let name = $('#input-1').val();
            let country = $('#input-2').val();
            let achievement = $('#input-3').val();
            let salary = $('#input-4').val();
            let role = $('#input-5').val();
            let username = $('#input-6').val();
            let password = $('#input-7').val();
            let image = $('#input-8')[0].files[0];
            formData.append('name', name);
            formData.append('country', country);
            formData.append('achievement', achievement);
            formData.append('salary', salary);
            formData.append('role', role);
            formData.append('username', username);
            formData.append('password', password);
            formData.append('avaFile', image);
            $.ajax({
                contentType: false,
                processData: false,
                enctype: 'multipart/form-data',
                dataType: "json",
                type: "POST",
                url: "http://localhost:2828/coach",
                data: formData,
                success: function (data) {
                    console.log(data);
                    showAllCoach();
                }
            })

        }
        function showFormUpdate(element){
            let id = element.getAttribute("href");
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "get",
                url: "http://localhost:2828/coach/"+id,
                success: function (data) {
                    console.log(data);
                    console.log(id);
                    $('#id').attr('value',`${data.id}`)
                    $('#name').attr('value',`${data.name}`)
                    $('#country').attr('value',`${data.country}`)
                    $('#achievement').attr('value',`${data.achievement}`)
                    $('#salary').attr('value',`${data.salary}`)
                    $('#role').attr('value',`${data.role}`)
                    $('#image').attr('value',`${data.image}`)
                }

            })

            event.preventDefault();
        }

        function updateCoach() {
            let id = $('#id').val();
            let name = $('#name').val();
            let country = $('#country').val();
            let achievement = $('#achievement').val();
            let salary = $('#salary').val();
            let role = $('#role').val();
            let image = $('#image').val();
            let editCoach={
                name:name,
                country:country,
                achievement:achievement,
                salary:salary,
                role:role,
                image:image,
            }
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "put",
                url: "http://localhost:2828/coach/"+id,
                data:JSON.stringify(editCoach),
                success: function (data) {
                    console.log("cap nhat thanh cong"+editCoach)
                    showAllCoach();
                }
            })

            event.preventDefault();
        }

        function deleteCoach(element){

            let id=element.getAttribute("href");
            $.ajax({
                type: "delete",
                url: "http://localhost:2828/coach/"+id,
                success:function (date){
                    console.log("Xoa thanh cong ");
                    showAllCoach();
                }
            })
            event.preventDefault();
        }
        function sortSalaryAsc(){
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type:"get",
                url: "http://localhost:2828/coach/sortAsc/",
                success:function (data){
                    let content="";
                    for (let i=0;i<data.length;i++){
                        content+=`<tr>
        <td>${data[i].id}</td>
        <td>${data[i].name}</td>
        <td>${data[i].country}</td>
        <td>${data[i].achievement}</td>
        <td>${data[i].salary}</td>
        <td>${data[i].role}</td>
        <td><img src="${'http://localhost:2828'+data[i].avatarURL}" width="80" height="80" alt="img"></td>
        <td><a href="${data[i].id}" onclick="deleteCoach(this)">Delete</a></td>
        <td><a href="${data[i].id}" onclick="showFormUpdate(this)">Update</a></td></tr>`;
                    }
                    document.getElementById("list").innerHTML = content;

                    console.log(data);

                    console.log("sort thanh cong")

                }
            })
        }

        function sortSalaryDesc(){
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type:"get",
                url: "http://localhost:2828/coach/sortDesc/",
                success:function (data){
                    let content="";
                    for (let i=0;i<data.length;i++){
                        content+=`<tr>
        <td>${data[i].id}</td>
        <td>${data[i].name}</td>
        <td>${data[i].country}</td>
        <td>${data[i].achievement}</td>
        <td>${data[i].salary}</td>
        <td>${data[i].role}</td>
        <td><img src="${'http://localhost:2828'+data[i].avatarURL}" width="80" height="80" alt="img"></td>
        <td><a href="${data[i].id}" onclick="deleteCoach(this)">Delete</a></td>
        <td><a href="${data[i].id}" onclick="showFormUpdate(this)">Update</a></td></tr>`;
                    }
                    document.getElementById("list").innerHTML = content;

                    console.log(data);

                    console.log("sort thanh cong")

                }
            })
        }
    </script>
</head>
<body>
<table>
    <tr>
        <td>name</td>
        <td><input type="text" name="name" id="name"></td>
    </tr>
    <tr>
        <td>country</td>
        <td><input type="text" name="country" id="country"></td>
    </tr>
    <tr>
        <td>achievement</td>
        <td><input type="text" name="achievement" id="achievement"></td>
    </tr>
    <tr>
        <td>salary</td>
        <td><input type="text" name="salary" id="salary"></td>
    </tr>
    <tr>
        <td>role</td>
        <td><input type="text" name="role" id="role"><br></td>
    </tr>
    <tr>
        <td>username</td>
        <td><input type="text" name="username" id="username"></td>
    </tr>
    <tr>
        <td>password</td>
        <td><input type="text" name="password" id="password"></td>
    </tr>
    <tr>
        <td>avatar</td>
        <td><input type="file" name="avatar" id="avatar"></td>
    </tr>
    <tr>
        <td>
            <button onclick="createCoach()">AddNewCoach</button>
        </td>
    </tr>
    <tr>
        <td>
            <button onclick="updateCoach()">UpdateCoach</button>
        </td>
    </tr>
    <tr>
        <td>
            <button onclick="sortSalaryAsc()">Lương tăng dần</button>
        </td>
    </tr>
    <tr>
        <td>
            <button onclick="sortSalaryDesc()">Lương giảm dần</button>
        </td>
    </tr>
</table>
<select>
    <option >Sắp xếp lương</option>
    <option onchange="sortSalaryAsc()">Lương tăng dần</option>
    <option onchange="sortSalaryDesc()">Lương giảm dần</option>
</select>
<table border="1" >
    <tr>
        <td>Id</td>
        <td>Name</td>
        <td>Country</td>
        <td>Achievement</td>
        <td>Salary</td>
        <td>Role</td>
        <td>Image</td>
        <td>Action</td>
        <td>Action</td>
    </tr>
    <tbody id="list"></tbody>
</table>
<!--<script src="home.js"></script>-->
</body>
</html>